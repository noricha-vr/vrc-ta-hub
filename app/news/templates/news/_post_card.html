{% load markdown_extras %}
<style>
  .news-thumbnail-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    overflow: hidden;
    border-radius: 0.5rem;
    background-color: #f8f9fa;
  }
  
  .news-thumbnail-container img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }
  
  .card:hover .news-thumbnail-container img {
    transform: scale(1.05);
  }
  
  .news-thumbnail-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 3rem;
    color: #dee2e6;
  }
</style>

<div class="col-12">
  <a class="card text-decoration-none shadow-sm" href="{% url 'news:detail' post.slug %}">
    <div class="card-body">
      <div class="row align-items-center">
        {% if post.thumbnail %}
          <div class="col-md-4 col-lg-3 mb-3 mb-md-0">
            <div class="news-thumbnail-container">
              <img src="{{ post.thumbnail.url }}" 
                   alt="{{ post.title|escape }}のサムネイル画像" 
                   loading="lazy">
            </div>
          </div>
          <div class="col-md-8 col-lg-9">
        {% else %}
          <div class="col-md-4 col-lg-3 mb-3 mb-md-0">
            <div class="news-thumbnail-container">
              <i class="bi bi-image news-thumbnail-placeholder"></i>
            </div>
          </div>
          <div class="col-md-8 col-lg-9">
        {% endif %}
          <div class="d-flex justify-content-between align-items-start mb-2">
            <h5 class="card-title mb-0">
              {% if not post.is_published %}
                <span class="badge bg-warning text-dark me-2">非公開</span>
              {% endif %}
              {{ post.title|escape }}
            </h5>
            <small class="text-muted">
              {% if post.published_at %}
                <time datetime="{{ post.published_at|date:'Y-m-d' }}">
                  {{ post.published_at|date:'Y/m/d' }}
                </time>
              {% else %}
                未公開
              {% endif %}
            </small>
          </div>
          <p class="card-text text-muted">
            {{ post.get_meta_description|truncatechars:150|escape }}
          </p>
          {% if show_category|default:True %}
            <small class="badge bg-outline-primary text-primary border">{{ post.category.name|escape }}</small>
          {% endif %}
        </div>
      </div>
    </div>
  </a>
</div>